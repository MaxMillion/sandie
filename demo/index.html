<!DOCTYPE html>
<html lang=en>
<head>
    <meta charset=utf-8 />
    <title>sandie</title>
    
    <!-- include the Sandie script -->
    <script src="../sandie.js"></script>

    <!-- the Sandie script does not use jQuery; it's just here for the demo -->
    <!-- Here, the host page includes jQuery v1.4.2 -->
    <script src="jquery.1.4.2.js"></script>
    
    <!-- set up demo -->
    <script>
        // shorthand for console logging
        var _ = console && console.log ? console.log : function(){};
    </script>
</head>

<body>
    <h1><a href="http://github.com/premasagar/sandie">Sandie</a></h1>
    <p>This demo shows that multiple versions of a script (in this case, different versions of jQuery) may be loaded side-by-side, without affecting each others' scope or namespace.</p>
    <p>Sandie does this by creating a temporary iframe document for the scripts to be sandboxed.</p>
    <p>View the source of this page to see what's going on.</p>
    <hr>
    <div id=demo></div>
    
    <script>
        var
            oldJQuery, reallyOldJQuery;
            
        function callback(){
            if (oldJQuery && reallyOldJQuery){        
                // update demo page report
                $('#demo').html(
                    '<h2>Demo results</h2>' +
                    '<p>' +
                        'Host page has jQuery ' +
                            jQuery.fn.jquery +
                        ', one sandbox has jQuery ' +
                            oldJQuery.fn.jquery +
                        ', and another sandbox has jQuery ' +
                            reallyOldJQuery.fn.jquery +
                        '.' +
                    '</p>'
                );
            }
        }
    
        sandie(
            // url or array of urls for scripts to load in the sandie
            'jquery.1.3.2.js', // this is an older version of jQuery than that in the host page

            // property (string) or properties (array) to be retrieved from the sandboxed window object
            'jQuery',
            
            function(sandboxedVariable){
                oldJQuery = sandboxedVariable;
                callback();
            }
        );
    
        sandie(
            'jquery.1.2.2.js', // an even older version of jQuery
            
            // property (string) or properties (array) to be retrieved from the sandboxed window object
            'jQuery',
            
            function(sandboxedVariable){
                reallyOldJQuery = sandboxedVariable;
                callback();
            }
        );
        
        
        
    </script>
</body>
</html>
